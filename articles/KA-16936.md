---
title: "AEM redirige l’utilisateur vers http lorsqu’il est accédé par SSL/TLS à l’équilibreur de charge arrêté | AEM"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/AEM-redirecting-back-to-http-on-accessed-via-SSL-terminated-Load-Balancer.html"
bug: false
article-created-by: Emily Geary
article-created-date: "4/12/2021 6:21:34 PM"
article-published-by: Emily Geary
article-published-date: "4/12/2021 6:26:15 PM"
version-number: 1
article-number: KA-16936
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=684ec8e8-bb9b-eb11-b1ac-000d3a3680d8"
exl-id: 52e50c09-67f2-46a2-90a7-df769d76a0dd
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '341'
ht-degree: 1%

---

# AEM redirige l’utilisateur vers http lorsqu’il est accédé par SSL/TLS à l’équilibreur de charge arrêté | AEM

## Description


Lors de l’accès à AEM par le biais d’un équilibreur de charge terminé par SSL (ou d’un réseau de diffusion de contenu arrêté par SSL), AEM redirige de https vers http.

La terminaison SSL à l’équilibreur de charge signifie que les certificats SSL sont installés dans l’équilibreur de charge. L’utilisateur final accède au site par l’intermédiaire de `https://`, et Dispatcher/Serveur web et AEM sont accessibles sur le serveur principal avec `http://`.



<b>Cause</b>

Les différents équilibreurs de charge envoient différents en-têtes pour avertir les systèmes principaux que SSL est arrêté en amont. Par exemple : [Amazon ELB utilise l’en-tête &quot;X-Forwarded-Proto: https&quot;](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html#x-forwarded-proto).


## Résolution


Pour résoudre le problème :

<b>I. Mise à jour de Dispatcher `/clientheaders` configuration</b>

Consultez la documentation de votre équilibreur de charge pour savoir quel en-tête il définit pour avertir les systèmes en aval qu’il a arrêté SSL. Pour plus de simplicité, dans ces étapes, nous supposons que l’en-tête HTTP correct est *`X-Forwarded-Proto: https`*

1. Connectez-vous au serveur Dispatcher.
2. Ouvrez la ferme de serveurs de Dispatcher. `.any` configuration.
3. Ajoutez l’en-tête au `/clientheaders` .


Si vous utilisez le répartiteur sans équilibreur de charge ou si votre équilibreur de charge ou votre proxy ne parvient pas à définir la variable `X-Forwarded-Proto` , puis vous pouvez le définir au niveau du serveur web ou du dispatcher. Si vous utilisez [!DNL Apache HTTP Server], puis mettez à jour votre VirtualHost HTTPS avec cette directive :


| 1 | `RequestHeader ` `set` `X-Forwarded-Proto ` `"https"` |
| --- | --- |


<b>II. Mettez à jour les configurations d’en-tête :</b>

1. Accédez à *http://host:port*/system/console/configMgr/org.apache.felix.http.sslfilter.SslFilter et connectez-vous en tant qu’administrateur.
2. Définissez l’en-tête de transfert SSL sur `X-Forwarded-Proto`.
3. Définissez la valeur de transfert SSL sur https.
4. Cliquez sur Enregistrer.


Remarque :

Il n’existe pas de norme pour les en-têtes de proxy inverse qui indiquent au serveur principal quel protocole est utilisé. Cependant, voici quelques-uns des noms connus :

- ELB Amazon ([!DNL Elastic Load Balancer]) utilise la variable `X-Forwarded-Proto: https` en-tête .
- [!DNL Amazon Cloudfront] Le réseau CDN utilise `X-Cloudfront-Proto: https` en-tête .


<b>III. Mise à jour de la configuration OSGi Jetty (AEM 6.3 et versions ultérieures)</b>

Sur AEM version 6.3 et ultérieure, une configuration supplémentaire est requise :

- Connectez-vous à http://aem-host:port/system/console/configMgr/org.apache.felix.http.
- Activation du paramètre <b>Activer la connexion de l’équilibreur de charge/proxy</b>et enregistrez-la.
