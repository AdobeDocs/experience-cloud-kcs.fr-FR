---
title: Analyse de la croissance inhabituelle du référentiel
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager 6.4,Experience Manager 6.5
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 9:42:02 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 2:45:04 PM
version-number: 1
article-number: KA-17496
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=6654cfb6-b732-ec11-b6e5-000d3a5ba97a
exl-id: 51d503fe-3da6-4cfc-a8c5-95f80da51ae8
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '582'
ht-degree: 2%

---

# Analyse de la croissance inhabituelle du référentiel

## Description


L’utilisation du disque augmente anormalement et rapidement sur un serveur AEM.
<br><br><br><br>Cause<br><br><br><br><br><br>
De nombreux éléments peuvent provoquer des augmentations inhabituelles de l’utilisation du disque.  Certaines causes potentielles :

1. Aucune maintenance correcte n’a été effectuée sur le système.  Voir [cet article](https://helpx.adobe.com/fr/experience-manager/kb/AEM6-Maintenance-Guide.html) pour plus d’informations sur les différentes activités de maintenance du système.
2. AEM ou l’application crée un très grand nombre de noeuds ou de mises à jour des propriétés de noeud.  Cela peut être dû à une mauvaise configuration ou à un bogue du code de l’application.  Comme le stockage tar dans Oak fonctionne en mode append uniquement, l’enregistrement répété des noeuds contribue à une croissance excessive du référentiel.
3. Un ou plusieurs fichiers très volumineux ont été chargés dans AEM Assets ou le gestionnaire de modules.
4. La journalisation de débogage ou de suivi a été laissée activée.



## Résolution

A. Si AEM est en cours d’exécution et qu’il y a un espace disque important<br><br><br><br> <br><br>1. CONFIGURATION DE LA JOURNALISATION DES TRACES D’ÉCRITURE OAK<br><br><br><br> <br><br>Si AEM est toujours en cours d’exécution, nous pouvons activer un enregistreur de débogage pour nous indiquer les chemins de référentiel dans lesquels sont écrits.  Pour activer ce journal, installez le package de configuration du journal joint ci-dessous ou procédez comme suit :
1. Accédez à <b>*http://aemhost:port*/system/console/slinglog</b>
2. Cliquez sur <b>Ajouter un nouvel enregistreur</b>
3. Configurez un journal : <b>Fichier journal : logs/repgrowth.log</b>, <b>Niveau de journal : trace</b>, <b>Enregistreurs :</b> <b>org.apache.jackrabbit.oak.jcr.operations.writes</b>


TÉLÉCHARGER
[Obtenir le fichier](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/analyze-unusual-repository-growth/jcr:content/main-pars/download/log_repository_growth-1.zip "log_repository_Growth-1.zip") <br><br>Ce package contient la configuration requise pour la session d’écriture de journalisation pour oak. Installez ce package via le gestionnaire de modules CRX. Après la période de contrôle, veillez à désinstaller le package.<br><br><br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br><br><br><br>
Attention :

- Le journal contient des informations concernant toutes les écritures et tous les détails de session.  Si vous utilisez cet enregistreur, assurez-vous que vous disposez de suffisamment d’espace disque.
- Désinstallez le package de configuration du journal ou supprimez la configuration du journal après une courte période de temps, afin d’éviter toute consommation d’espace disque supplémentaire.



<br><br><br><br> <br><br>2. EXÉCUTION DU RAPPORT UTILISATION DU DISQUE<br><br><br><br> <br><br>
Vous pouvez également exploiter le rapport Utilisation du disque . <b>*http://host:port*/etc/reports/diskusage.html</b>.Ce rapport affiche l’espace disque utilisé par le chemin du référentiel.  Le rapport peut être percé, ce qui vous permet également d’afficher les sous-arborescences.
<br><br><br><br> <br><br>3. CAPTURER DES FICHIERS DUMPS DE FIL ET EFFECTUER UN PROFILEMENT<br><br><br><br> <br><br>
Après avoir utilisé la variable <b>[repGrowth.log](https://helpx.adobe.com/experience-manager/kb/analyze-unusual-repository-growth.html#repgrowth)</b> pour avoir une idée des données en cours d’écriture, nous pouvons obtenir des informations sur le code qui écrit ces données en capturant des images mémoire de threads et en exécutant le profilage du processeur.

Reportez-vous aux articles suivants :

- [Profil du processeur](https://helpx.adobe.com/experience-manager/kb/AnalyzeUsingBuiltInProfiler.html)
- [Capture des images mémoire de threads](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html)
- [Analyse des vidages de threads AEM](https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html)

<br><br><br><br> <br><br>B. Si AEM est arrêté et/ou que l’espace disque est presque épuisé<br><br><br><br> <br><br>
Si vous deviez arrêter AEM afin d&#39;éviter la croissance de l&#39;espace disque, utilisez les commandes ci-dessous pour effectuer une analyse initiale.

Sur la plateforme Linux, utilisez la méthode <b>du</b> pour répertorier tous les répertoires sous <b>crx-quickstart</b> avec la taille résumée de ces répertoires :

du -h —max-depth=2 crx-quickstart

Utilisation <b>find</b> et <b>du</b> pour rechercher les fichiers récemment modifiés et obtenir leur taille :

find crx-quickstart -type f -mtime 1 -exec du -hs {} \; -print

Pour rechercher des fichiers volumineux dans la banque de données, vous pouvez combiner des <b>find</b>, <b>du</b> et <b>fichier</b> pour rechercher des fichiers de plus de 100 Mo dans le <b>datastore</b> et identifiez automatiquement leur type de fichier :

find crx-quickstart/repository/datastore -type f -size +100M -exec sh -c &quot;du -hs \&quot;{}\&quot;; file \&quot;{}\&quot;&quot; \;

Si vous constatez que la croissance se produit dans la variable <b>segmentstore</b> , puis la commande ci-dessous peut vous donner des indices sur les données en cours d’écriture :

chaînes data_xxxxxx.tar | egrep &#39;.?/&#39; | sed &#39;s/.$//;s/.\//\/&#39;
