---
title: Comment bloquer les adresses IP au niveau du serveur Apache HTTP ? | AEM Dispatcher
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/20/2021 6:52:14 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 2:11:29 PM
version-number: 1
article-number: KA-17455
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=448e02d5-d631-ec11-b6e5-000d3a5ba97a
exl-id: b1913734-7b1e-4f91-a886-6537b4716e7f
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '285'
ht-degree: 3%

---

# Comment bloquer les adresses IP au niveau du serveur Apache HTTP ? | AEM Dispatcher

## Description


Notre site subit une attaque par déni de service, du spam ou est piraté. Comment bloquer les adresses IP au niveau du serveur HTTP Apache (AEM Dispatcher) ?


## Résolution


La plupart des pare-feu d’applications web (WAF), tels que la sécurité mod, peuvent contenir des listes bloquées d’adresses IP. Cependant, si vous exécutez Apache HTTP Server et souhaitez bloquer les adresses IP, procédez immédiatement comme suit (<b>Non applicable sur AEM as a Cloud Service)</b>:

- Créez un fichier nommé block-offending-ips.conf sur votre serveur.
- Ouvrez le fichier dans un éditeur et ajoutez une directive d’emplacement qui empêche toutes les adresses IP incriminées d’accéder aux URL que vous souhaitez bloquer.  Il existe deux options pour le contenu du fichier ci-dessous :


<b>A. </b>Si la requête est en proxy (via CDN, équilibreur de charge, etc.) et que l’adresse IP de l’utilisateur distant n’est que dans un en-tête tel que X-Forwarded-For, cette configuration peut être utilisée.  Notez que cette configuration ne s’applique pas si remoteip_module est configuré.


| 1<br>  2<br>  3<br>  4<br>  5<br>  6<br>  7<br>  8 | `LocationMatch ``"/.*"````Order Allow,Deny``Allow from all``SetEnvif X-Forwarded-For ``"10\.42\.137\.123"` `DenyAccess``SetEnvif X-Forwarded-For ``"122\.6\.218\.101"` `DenyAccess``#Repeat the "SetEnvlf X-Forwarded-For ..." for each IP you want to block``Refuser de ``env``=DenyAccess&quot;/LocationMatch&quot; |
| --- | --- |

<br><br><br><br><br> <br><br>
<b>B. </b>Sinon, si l’utilisateur distant accède directement à Apache ou si vous utilisez remoteip_module (voir [1](https://helpx.adobe.com/experience-manager/kb/block-ips-apache-http-server.html#remoteip_module)) pour l’extraire et le définir dans Apache, vous pouvez utiliser directement la fonction Require de mod_authz_core (Apache 2.4).


| 1<br>  2<br>  3<br>  4<br>  5<br>  6<br>  7<br>  8 | `LocationMatch ``"/.*"````RequireAll``Exiger que tout soit accordé``Require not ip 10.42.137.123``Ne nécessite pas ip 122.6.218.101&quot;#Repeat the &quot;Require not ip ...&quot; pour chaque adresse IP que vous souhaitez bloquer&quot;/RequireAll&quot;/LocationMatch&quot; |
| --- | --- |

<br><br><br><br><br> <br><br>
1
<br><br><br><br><br> <br><br><br><br>

| `# Extraction de la véritable adresse IP du client de l’en-tête ajouté par l’équilibreur de charge/CDN``IfModule remoteip_module``    ``# valid for ELB or ELB+CloudFront``    &quot;RemoteIPHeader X-Forwarded-For&quot;/IfModule&quot; |
| --- |

 
- Déposez le fichier block-offending-ips.conf dans le dossier /etc/conf.d du serveur web Apache.


- Redémarrez le serveur Apache HTTP.
