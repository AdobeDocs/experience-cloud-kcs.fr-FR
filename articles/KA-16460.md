---
title: "Comment réindexer un index AEM synchrone | AEM, Oak"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:19:48 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:21:41 PM"
version-number: 2
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3613fb7d-6687-eb11-a812-000d3a593216"
exl-id: 1209609f-84a9-4810-b7c8-1193b09f82d7
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '412'
ht-degree: 0%

---

# Réindexation d’un index d’AEM synchrone | AEM, Oak

## Description


Comment réindexer correctement un index Oak synchrone sans provoquer de temps d’arrêt ?


## Résolution


La réindexation d’un index synchrone en définissant simplement la propriété reindex sur true entraîne une opération synchrone qui peut entraîner le blocage d’une instance Oak. Pour éviter cette situation, envoyez l’indexation à un thread d’arrière-plan.  Pour ce faire, procédez comme suit :

<b>Étape 1 :</b> Réindexation dans un thread d’arrière-plan

1. Définissez les propriétés suivantes de CRXDE Lite sur la définition d’index pour que l’index de propriété soit activé pour l’indexation asynchrone - `/oak:index/property` index

   `reindex=true`

   `reindex-async=true`
2. Pour vérifier que le noeud ci-dessus actualise le noeud, `async="async-reindex"` doit être définie.
3. Appeler la variable `startPropertyIndexAsyncReindex` sur le `PropertyIndexAsyncReindex` MBean. Cela lancerait la tâche d’arrière-plan qui rechercherait de tels types d’index. Après un appel, vous devriez voir une ligne de journal La réindexation sera effectuée...
4. Une fois la réindexation terminée, l’indicateur de réindexation est réinitialisé sur false.
5. Réappelez l’étape 3 pour rétablir l’index en index de synchronisation. Si l’indicateur asynchrone n’est pas supprimé, le MBean doit peut-être être appelé plusieurs fois (cela peut se produire si des modifications se produisent simultanément et affectent cet index).



*Remarque :* Seule la variable `async="async-reindex"` sera supprimé, car il contrôle le thread sur lequel l’indexation se produira.  Le `reindex-async` est simplement un indicateur de configuration qui ne change pas automatiquement. L’idée est que vous la définissiez une fois pour les définitions d’index spécifiques contrôlant toute réindexation future. On s&#39;attend alors à ce qu&#39;il reste là-dedans et que vous n&#39;ayez plus à le toucher.


<b>Étape 2 :</b> Supprimez le point de contrôle de réindexation (AEM 6.2 et versions antérieures uniquement).

Pendant le processus de réindexation asynchrone, un point de contrôle de référentiel est créé. Une fois la tâche d’indexation terminée, elle doit être publiée comme décrit ci-dessous, afin de garantir un nettoyage fluide de la mémoire d’analyse plus tard le :

1. Tout d’abord, ouvrez le MBean CheckpointManager :

   MongoMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3Document+node+store+checkpoint+management%2Ctype%3DCchakpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCchakpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. Appeler la variable `listCheckpoints()` operation
3. Recherchez la ligne de point de contrôle avec le `name=async-reindex` .
4. Copie de sa valeur d’identifiant dans le presse-papiers

   Sur MongoMK, cela ressemblera à ceci : `r1234567aaaa-0-1`

   Sur TarMK, cela ressemblera à ceci : `6eac07d0-fe27-4d16-82f8-6d5da4cefd67`
5. Ouvrez ensuite le `releaseCheckpoint()` opération.
6. Collez l’ID copié en tant que p1 et cliquez sur &quot;Invoquer&quot;.
7. Cette étape libérera le point de contrôle.
