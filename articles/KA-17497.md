---
title: "Quelles requêtes AEM cache Dispatcher ?"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, AEM dispatcher, cache, AEM, requête HTTP"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Nayanika Chakravarty
article-created-date: "3/24/2023 2:43:29 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "3/24/2023 2:47:38 PM"
version-number: 5
article-number: KA-17497
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=d44fd637-52ca-ed11-b597-6045bd006b25"
source-git-commit: 4cfb18b1dece1e79e487cc1430280e87be02c4fa
workflow-type: tm+mt
source-wordcount: '381'
ht-degree: 8%

---

# Quelles requêtes AEM le cache de Dispatcher ?

## Description {#description}


<b>Environnement</b>

AEM Dispatcher 4.3.3

<b>Problème</b>

Cet article détermine pourquoi la requête/réponse HTTP n’est pas mise en cache par le Dispatcher AEM.


## Résolution {#resolution}


La documentation couvre les scénarios les plus importants qui affectent la capacité de mise en cache des requêtes et réponses qui transitent par le module de Dispatcher AEM. Toutes les règles de cache ne sont pas traitées.

<b>Règles de requête et de mise en cache HTTP</b>

Pour qu’une requête HTTP puisse être mise en cache par le Dispatcher, elle doit respecter les règles suivantes :

1. L’URL est absolue (ne fonctionne pas avec . ou ..), a une extension de fichier et le nom de fichier dans l’URL fonctionne comme un fichier sur le système de fichiers.

   Messages de journal associés :


   ```
   URI not canonical: %s.
   
   Unable to map URI to file: %s.
   
   cache file path too long
   
   temporary file path too long
   
   request URL has no extension
   ```



   Exemples :


   | `/content/test` | `not cached` |
   | --- | --- |
   | `/content/test.html` | `cached` |


2. Il ne comporte aucune barre oblique après la première extension de fichier.

   Messages de journal associés :


   ```
   request URL has trailing slash
   ```



   Exemples :


   | `/content/test.html/` | `not cached` |
   | --- | --- |
   | `/content/test.html/foo.jpg` | `not cached` |
   | `/content/test.html` | `cached` |


3. Il utilise la méthode HTTP GET ou HEAD.

   Messages de journal associés :


   ```
   request method is neither GET nor HEAD
   ```



   Exemples :


   | `HEAD /content/test.html HTTP/1.1` | `cached` |
   | --- | --- |
   | `GET /content/dam/test.jpg HTTP/1.1` | `not cached` |
   | `POST /content/test.html HTTP/1.1` | `not cached` |


4. La demande est refusée par /CACHE = /RULES défini dans le Dispatcher. TOUTE CONFIGURATION DE FERME.
Messages de journal associés :


   ```
   URI not  in cache rules: %s request URL not in cache rules
   ```



   Exemples :


   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html    /cache    {     ...     /rules     {      /0001 {      type "deny"      glob "*"      }     }    }<br>    ```<br><br> | `not cached` |
   | --- | --- |
   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html    /cache    {     ...     /rules     {      /0001 {      type "allow"      glob "*"      }     }    }<br>    ```<br><br> | `cached` |


5. La requête HTTP ne contient pas d’en-tête d’autorisation ou elle contient l’en-tête , mais /ALLOWAUTHORIZED est défini sur 1 dans la CONFIGURATION DE LA FERME.
Messages de journal associés :


   ```
   request contains authorization
   ```



   Exemples :


   | <br><br>    ```<br>    HTTP Request:        GET /content/test.html HTTP/1.1    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l    dispatcher.any farm /cache = /allowAuthorized configuration:    /cache {     /allowAuthorized “0”    }<br>    ```<br><br> | `not cached` |
   | --- | --- |
   | Requête HTTP :<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Cookie: authorization=YWxhZGRpbjpvcGVuc2VzYW1l<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “0”<br>    }<br>    ```<br><br> | non mis en cache |
   | Requête HTTP :<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Cookie: login-token=…<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “1”<br>    }<br>    ```<br><br> | Mis en cache |


6. Il existe un paramètre QUERYSTRING dans l’URL et le paramètre peut être ignoré via la CONFIGURATION /IGNOREURLPARAMS DE LA FERME.

   Messages de journal associés :


   ```
   request contains a query string
   ```



   Exemples :


   | Requête HTTP :<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    Farm /cache configuration:<br>    <br>    /ignoreUrlParams {<br>     /0001 { /type “allow” /glob “*” }<br>    }<br>    ```<br><br> | Mis en cache |
   | --- | --- |
   | Requête HTTP :<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    Farm /cache configuration:<br>    <br>    /ignoreUrlParams {<br>     /0001 { /type “deny” /glob “*” } <br>      <br>     /0001 { /type “allow” /glob “test” }<br>    }<br>    ```<br><br> | Mis en cache |
   | Requête HTTP :<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /ignoreUrlParams {<br>    <br>     /0001 { /type “deny” /glob “*” } <br>      <br>     /0001 { /type “allow” /glob “q” }<br>    }<br>    ```<br><br> | non mis en cache |




<b>Règles de réponse et de mise en cache HTTP :</b>



La réponse HTTP renvoyée par l’AEM peut être mise en cache si les critères suivants sont satisfaits :

1. Dispatcher peut envoyer et recevoir une réponse 200 OK de l’un des &quot;RENDERS&quot; définis.

   <b>Remarque :</b> Si non [/timeout](https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html?lang=fr) est défini sur /renders ou est défini sur 0, il attend indéfiniment une connexion à l’instance AEM même si l’instance est hors service.


   Messages de journal associés :


   ```
   Unable to send request to remote server. Unable to receive response from remote server. Remote server returned: %s No backend available.
   ```



   Exemples :


   | Requête HTTP :<br><br>    200 OK | Mis en cache |
   | --- | --- |
   | Requête HTTP :<br><br>    404 Page introuvable | non mis en cache |


2. Aucun de ces en-têtes de réponse n’est présent dans la réponse :

   - `Dispatcher: no-cache`
   - `Cache-control: no-cache`
   - `Pragma: no-cache`

   Messages de journal associés :


   ```
   Backend forbids caching: %s, sent: %s" response contains no_cache
   ```



   Exemples :


   | Réponse HTTP :<br><br>    200 OK<br><br>    Dispatcher : no-cache | non mis en cache |
   | --- | --- |
   | Réponse HTTP :<br><br>    200 OK<br><br>    Cache-control : no-cache | non mis en cache |
   | Réponse HTTP :<br><br>    200 OK<br><br>    Pragma : no-cache | non mis en cache |
   | Réponse HTTP :<br><br>    200 OK | Mis en cache |


3. La valeur de longueur du contenu est supérieure à zéro OCTETS.


   Messages de journal associés :


   ```
   response content length is zero
   ```



   Exemples :


   | Réponse HTTP :<br><br>    200 OK<br><br>    Content-Length: 0 | non mis en cache |
   | --- | --- |
   | Réponse HTTP :<br><br>    200 OK<br><br>    Content-Length: 3120 | Mis en cache |



