---
title: "Comment cloner une instance TarMK en AEM"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "From https://helpx.adobe.com/experience-manager/kb/how-to-clone-an-AEM-TarMK-instance-AEM.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/24/2021 11:36:07 PM"
article-published-by: Emily Geary
article-published-date: "3/24/2021 11:37:50 PM"
version-number: 2
article-number: KA-16875
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=371b76b1-f98c-eb11-a812-000d3a58b9d1"
exl-id: d9c35199-775f-4f24-8d30-3828bb11e7f6
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '196'
ht-degree: 4%

---

# Comment cloner une instance TarMK en AEM

## Description


Cet article explique comment cloner correctement une instance AEM qui utilise TarMK (ou TarMK + FileDataStore) pour le stockage.


## Résolution


Les étapes ci-dessous montrent comment copier une instance AEM + TarMK + FileDataStore à l’aide de rsync sous Linux avec AEM installé sous /mnt/aem/author.

1. Copiez l’instance d’AEM complète sur un autre serveur pendant son exécution à l’aide d’une commande telle que rsync.  Veillez à conserver les horodatages pendant le processus de copie et à exclure le dossier journaux et la banque de données.  Par exemple: `rsync -av --exclude 'crx-quickstart/logs' --exclude 'crx-quickstart/repository/repository/datastore' /mnt/aem/author user@dest-host:/mnt/aem/`
2. Arrêter AEM
3. Lancez une autre copie du dossier de stockage de segments TarMK pour obtenir les modifications les plus récentes depuis la première copie : `rsync -av /mnt/aem/author/crx-quickstart/repository/segmentstore/* user@dest-host:/mnt/aem/author/crx-quickstart/repository/segmentstore/`
4. Démarrez AEM.
5. Copiez la banque de données pendant l’exécution d’AEM. Par exemple: `rsync -av /mnt/aem/author user@dest-host:/mnt/aem/crx-quickstart/repository/repository/datastore /mnt/aem/crx-quickstart/repository/repository/`
6. Sur le serveur de destination, recréez le dossier journaux, supprimez le dossier crx-quickstart/repository/index et supprimez le fichier sling.id.file du dossier crx-quickstart/launchpad/felix.

`mkdir /mnt/aem/crx-quickstart/logs`

`rm -rf /mnt/aem/crx-quickstart/repository/index`

`find /mnt/aem/crx-quickstart/launchpad/felix -type f -name "sling.id.file" -exec rm -f {} \; -print`
7. Sur le serveur de destination, démarrez AEM et testez votre instance.


<b>Remarque importante :</b>

Vous devez vous assurer que la banque de données est copiée après le dossier segmentstore et que tous les horodatages sont conservés pendant la copie.  La synchronisation permet de conserver les horodatages avec l’option -a.
