---
title: "ProductAssetListener peut entraîner des problèmes de performances et SegmentNotFoundException"
description: Description
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "CQ-4309643"
bug: true
article-created-by: Nobuhiro Hashimoto
article-created-date: "9/1/2021 2:18:18 PM"
article-published-by: Nobuhiro Hashimoto
article-published-date: "9/1/2021 2:19:22 PM"
version-number: 3
article-number: KA-17242
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=a27a3073-2f0b-ec11-b6e6-00224808dc0d"
exl-id: c976efd3-364f-40a4-b344-e9c24f96216e
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '253'
ht-degree: 16%

---

# ProductAssetListener peut entraîner des problèmes de performance et SegmentNotFoundException.

## Description


ProductAssetListener peut entraîner des problèmes de performance et de SegmentNotFoundException dans AEM 6.5.6, AEM 6.5.7 et la version 6.4.6 d’Adobe.



Le message d’erreur type de SegmentNotFoundException par ce problème contient la trace de suivi comme ci-dessous.

\*ERREUR\* sling-oak-observation-4 org.apache.jackrabbit.oak.segment.SegmentNotFoundExceptionListener Segment introuvable : 6376814a-9273-4df8-aedd-ec5e6eb7ab52. SegmentId age=238801954ms,segment-generate=GCGeneration{generate=139,fullGeneration=47,isCompacted=false}

org.apache.jackrabbit.oak.segment.SegmentNotFoundException : Segment 6376814a-9273-4df8-aedd-ec5e6eb7ab52 introuvable ... à l’adresse com.adobe.cq.commerce.impl.asset.ProductAssetListener.onEvent(ProductAssetListener.java:153)



Les problèmes de performances peuvent être la lenteur, l’absence de réponse et le délai/blocage de la file d’attente de réplication. Lorsque le problème commence, le message suivant apparaît dans error.log.

\*WARN\* sling-oak-observation-4 com.adobe.cq.commerce.impl.asset.ProductAssetListener NODE_MOVED pour l’événement /content/dam/asset/metadata n’a pas d’informations d’événement requises



Les vidages de threads pendant le problème contiennent un thread d’observation sling-oak avec ProductAssetList s’exécute de manière agressive.

&quot;sling-oak-observation-4&quot; prio=5 tid=0xd7 nid=0xffffffffff runnable ... à l’adresse com.adobe.cq.commerce.impl.asset.ProductAssetListener.onEvent(ProductAssetListener.java:153)


## Résolution


Ce problème a été corrigé avec AEM 6.5.8.

[https://experienceleague.adobe.com/docs/experience-manager-65/release-notes/service-pack/previous-hotfixes-featurepacks.html?lang=en](https://experienceleague.adobe.com/docs/experience-manager-65/release-notes/service-pack/previous-hotfixes-featurepacks.html?lang=en)

La mise à jour de la référence des ressources du produit entraîne le statut En attente des threads de réplication jusqu’à ce que le thread ProductAssetListener termine ses validations dans le JCR (NPR-35269).



Pour AEM 6.4.6+, la désactivation du composant OSGi com.adobe.cq.commerce.impl.asset.ProductAssetListener est une solution de contournement. Pour ce faire, vous pouvez utiliser Component Disabler dans ACS AEM Commons.

[https://adobe-consulting-services.github.io/acs-aem-commons/features/osgi-disablers/component-disabler/index.html](https://adobe-consulting-services.github.io/acs-aem-commons/features/osgi-disablers/component-disabler/index.html)



Comment configurer Component Disabler :

1. Dans CRX/DE, créez un noeud sling:OSGiConfig sous la forme /apps/your project/config/com.adobe.acs.commons.util.impl.ComponentDisabler.

2. Ajoutez une propriété String avec le nom = &quot;components&quot;, valeur = &quot;com.adobe.cq.commerce.impl.asset.ProductAssetListener&quot;
