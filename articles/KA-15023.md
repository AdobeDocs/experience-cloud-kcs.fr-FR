---
title: "Mise en oeuvre de Video Analytics dans Adobe Launch"
description: Description
solution: Customer Journey Analytics,Analytics
product: Customer Journey Analytics,Analytics
applies-to: "Customer Journey Analytics,Analytics"
keywords: "KCS Launch Video Analytics Heartbeat"
resolution: Resolution
internal-notes: "This implementation discussed in this article does not use Adobe Launch extension for Media Analytics."
bug: false
article-created-by: Krunal Oza
article-created-date: "9/16/2022 9:07:03 AM"
article-published-by: Krunal Oza
article-published-date: "9/16/2022 9:25:26 AM"
version-number: 3
article-number: KA-15023
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=ee0b6fe9-9e35-ed11-9db1-002248086a9c"
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '1055'
ht-degree: 0%

---

# Mise en oeuvre de Video Analytics dans Adobe Launch

## Description

<br>Environnement<br><br>


Cet article décrit les étapes de mise en oeuvre du suivi vidéo YouTube dans Adobe Launch à l’aide du SDK Media Heartbeat.


<br><br>Problème/Symptômes<br><br>
<b>Conditions préalables</b>


| <ol>   <li>Vous disposez d’une principale mise en oeuvre de Launch par Adobe.</li>   <li>La suite de rapports est activée pour Media Collection.</li>   <li>La suite de rapports est mappée à la société de connexion Analytics correcte dans Adobe Experience Cloud.</li>   <li>Vous disposez des droits de publication dans Adobe Launch.</li>   <li>Vous connaissez l’interface utilisateur d’Adobe Launch et son fonctionnement.</li>  </ol><br> |
| --- |



## Résolution


<b>ÉTAPE 1 : Créer une règle</b>

Créez une nouvelle règle dans votre propriété Launch Adobe en cliquant sur le bouton &quot;Ajouter une règle&quot; sous l’onglet &quot;Règles&quot;. Cette règle contient la condition d’événement pour charger la vidéo YouTube et les scripts de l’API Video Analytics et YouTube iFrame.

- Indiquez le nom de la règle dans la zone de texte Nom .




<b>ÉTAPE 2 : Ajout d’événements et/ou de conditions</b>

Cliquez sur le bouton + sous Événement et conditions pour créer des conditions de lancement de la vidéo YouTube. Dans mon exemple, j’ai ajouté une condition &quot;Élément existant&quot; pour rechercher une balise div spécifique &quot;lecteur&quot; afin de lancer la vidéo YouTube.



<b>ÉTAPE 3 : Ajout d’actions - Variables de configuration</b>

Cliquez sur le bouton + sous Actions pour créer un élément d’action. Cela fonctionnera comme un point unique de configuration pour la configuration des variables Video Analytics. J’ai utilisé des valeurs codées en dur. Cependant, vous pouvez utiliser des éléments de données pour renseigner ces variables.

1. Sélectionnez &quot;Core&quot; dans la liste déroulante Extension .
2. Sélectionnez &quot;Code personnalisé&quot; dans la liste déroulante Type d’action .
3. Ajoutez le nom de l’action dans la zone de texte Nom .
4. Sélectionnez &quot;Javascript&quot; sous Langue.
5. Cochez &quot;Exécuter globalement&quot;.
6. Cliquez sur &quot;Ouvrir l’éditeur&quot;.
7. Ajoutez le code, puis cliquez sur Enregistrer. Veillez à mettre à jour les valeurs en fonction de votre société et de votre suite de rapports.



```
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
```


(function() { &#39;use strict&#39;;     // Exporter les symboles.
    window.Configuration = { PLAYER: { NAME : &#39;exemple de nom du lecteur&#39; //VIDEO_ID: &#39;sample video id&#39;, //VIDEO_NAME: exemple de nom de vidéo&quot; }, VISITEUR : { MARKETING_CLOUD_ORG_ID: &#39;experience cloud ID&#39;, TRACKING_SERVER: &#39;serveur de suivi&#39;, DPID: &#39;&#39;, DPUUID: &#39;&#39; }, APP_MEASUREMENT: { RSID: &#39;identifiant de suite de rapports&#39;, TRACKING_SERVER: &#39;serveur de suivi&#39;, PAGE_NAME: &#39;page name&#39;, CHAR_SET: &#39;UTF-8&#39; }, HEARTBEAT: { TRACKING_SERVER: &#39;serveur de suivi de pulsation&#39;, PUBLISHER: &#39;id d’éditeur&#39;, CHANNEL : &#39;channel&#39;, OVP: &quot;ovp name&quot;, SDK : &#39;version sgk&#39;, SSL : &quot;false&quot;, DEBUG : &#39;true&#39; }; })();



<b>ÉTAPE 4 : Ajout d’actions Service d’identification des visiteurs</b>

Media Analytics nécessite une instance du service d’identification des visiteurs. Vous devez télécharger le code du service d’identification des visiteurs à partir du gestionnaire de code dans l’interface utilisateur d’Adobe Analytics.

Une fois que vous avez téléchargé le code du service d’identification des visiteurs, cliquez sur le bouton + sous Actions pour créer un élément d’action, puis

1. Sélectionnez &quot;Core&quot; dans la liste déroulante Extension .
2. Sélectionnez &quot;Code personnalisé&quot; dans la liste déroulante Type d’action .
3. Ajoutez le nom de l’action dans la zone de texte Nom .
4. Sélectionnez &quot;Javascript&quot; sous Langue.
5. Cochez &quot;Exécuter globalement&quot;.
6. Cliquez sur &quot;Ouvrir l’éditeur&quot;.
7. Dans la partie inférieure, ajoutez le code suivant et cliquez sur Enregistrer.
8. Dans la partie inférieure, ajoutez le code suivant et cliquez sur Enregistrer.


var visitor = Visitor.getInstance(&quot;Experience Cloud ID&quot;, { trackingServer : &quot;serveur de suivi&quot;, // identique à s.trackingServer trackingServerSecure : &quot; serveur de suivi &quot; // identique à s.trackingServerSecure });

<b>ÉTAPE 5 : Ajout d’actions - Code Appmeasurement</b>

Media Analytics nécessite une instance d’Appmeasurement. Vous devez le télécharger à partir du Gestionnaire de code dans l’interface utilisateur d’Adobe Analytics.

Une fois que vous avez téléchargé le code AppMeasurement, cliquez sur le bouton + sous Actions pour créer un élément d’action, puis

1. Sélectionnez &quot;Core&quot; dans la liste déroulante Extension .
2. Sélectionnez &quot;Code personnalisé&quot; dans la liste déroulante Type d’action .
3. Ajoutez le nom de l’action dans la zone de texte Nom .
4. Sélectionnez &quot;Javascript&quot; sous Langue.
5. Cochez &quot;Exécuter globalement&quot;.
6. Cliquez sur &quot;Ouvrir l’éditeur&quot;.
7. Ajoutez le code du service d’identification des visiteurs.
8. Dans la partie supérieure, ajoutez le code suivant et cliquez sur Enregistrer.

<br><br><br>// Initialisation d’AppMeasurement
<br>var s_account=&quot;report suite id&quot;
<br>var s=s_gi(s_account)
<br>/\*\*\*\*\*\*\*\*\* CONFIGURATION DU SERVICE D’IDENTIFIANT VISITEUR - REQUIERT VisitorAPI.js \*\*\*\*\*\*\*\*\*/
<br>s.visitor=Visitor.getInstance(&quot;ID Experience Cloud&quot;)<br><br><br>
<b>ÉTAPE 6 : Ajout d’actions - Code Heartbeat</b>

Téléchargement du SDK Heartbeat à partir de [https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs](https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs).

Une fois que vous avez téléchargé le code Heartbeat, cliquez sur le bouton + sous Actions pour créer un élément d’action, puis

1. Sélectionnez &quot;Core&quot; dans la liste déroulante Extension .
2. Sélectionnez &quot;Code personnalisé&quot; dans la liste déroulante Type d’action .
3. Ajoutez le nom de l’action dans la zone de texte Nom .
4. Sélectionnez &quot;Javascript&quot; sous Langue.
5. Cochez &quot;Exécuter globalement&quot;.
6. Cliquez sur &quot;Ouvrir l’éditeur&quot;.
7. Ajoutez le code du service d’identification des visiteurs.
8. Dans la partie inférieure, ajoutez le code suivant et cliquez sur Enregistrer.


//Créer une référence locale aux classes MediaHeartbeat

var MediaHeartbeat = ADB.va.MediaHeartbeat; var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig; var MediaHeartbeatDelegate = ADB.va.MediaHeartbeatDelegate;

//Initialisation de Media Heartbeat

var mediaConfig = new MediaHeartbeatConfig(); mediaConfig.trackingServer = Configuration.HEARTBEAT.TRACKING_SERVER; mediaConfig.playerName = Configuration.PLAYER.NAME; mediaConfig.channel = Configuration.HEARTBEAT.CHANNEL; mediaConfig.debugLogging = Configuration.HEARTBEAT.DEBUG;

mediaConfig.appVersion = Configuration.HEARTBEAT.SDK; mediaConfig.ssl = Configuration.HEARTBEAT.SDK; mediaConfig.ovp = Configuration.HEARTBEAT.OVP;

// Mettre en oeuvre le protocole MediaHeartbeatDelegate .
var mediaDelegate = new MediaHeartbeatDelegate();

// Initialiser

var appMeasurement = new AppMeasurement(); appMeasurement.visitor = visitor; appMeasurement.trackingServer = Configuration.APP_MEASUREMENT.TRACKING_SERVER; appMeasurement.account = Configuration.APP_MEASUREMENT.RSID; appMeasurement.pageName = Configuration.APP_MEASUREMENT.PAGE_NAME; appMeasurement.charSet = Configuration.APP_MEASUREMENT.CHAR_SET; var contextData = { pageURL: document.URL, isUserLoggedIn: &quot;false&quot;, tvStation : &quot;Sample TV station&quot;, programmeur : &quot;Khurshid Alam&quot; }; var mediaInfo; var videostarted = false; var metaDataLoaded = false;



<b>ÉTAPE 7 : Ajout d’actions - Code de l’API YouTube IFrame</b>

1. Sélectionnez &quot;Core&quot; dans la liste déroulante Extension .
2. Sélectionnez &quot;Code personnalisé&quot; dans la liste déroulante Type d’action .
3. Ajoutez le nom de l’action dans la zone de texte Nom .
4. Sélectionnez &quot;Javascript&quot; sous Langue.
5. Cochez &quot;Exécuter globalement&quot;.
6. Cliquez sur &quot;Ouvrir l’éditeur&quot;.
7. Ajoutez le code suivant et cliquez sur Enregistrer.


// 2. Ce code charge le code de l’API du lecteur IFrame de manière asynchrone.

var tag = document.createElement(&#39;script&#39;); tag.src = &quot;https://www.youtube.com/iframe_api&quot;; var firstScriptTag = document.getElementsByTagName(&#39;script&#39;)0; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3. Cette fonction crée un iframe (et le lecteur YouTube) // après le téléchargement du code de l’API.

var player; fonction onYouTubeIframeAPIReady() { console.log(&quot;onYouTubeIframeAPIReady named...&quot;);        player = new YT.Player(&#39;player&#39;, { height: &#39;390&#39;, largeur : &#39;640&#39;, videoId: &#39;xWYHvIjvMnY&#39;, événements : { &#39;onReady&#39; : onPlayerReady, &#39;onStateChange&#39; : onPlayerStateChange, &#39;onPlaybackQualityChange&#39; : onPlayerPlaybackQualityChange, &#39;onPlaybackRateChange&#39; : onPlayerPlaybackRateChange, &#39;onError&#39;: onPlayerError }); }

// 4. L’API appelle cette fonction lorsque le lecteur vidéo est prêt.

function onPlayerReady(event) { metaDataLoaded = true;        player.playVideo(); }

// 5. L’API appelle cette fonction lorsque l’état du lecteur change.
// La fonction indique que lors de la lecture d’une vidéo (state=1), // le lecteur doit lire pendant six secondes, puis s’arrêter.

function onPlayerStateChange(event) { switch (event.data){ case YT.PlayerState.PLAYING:  console.log(&quot;\*\*\*HB Playing&quot;);                      if(metaDataLoaded){ if (Math.floor(event.target.getCurrentTime()) == 0) { console.log(&quot;\*\*\*HB Start&quot;);                                    MediaHeartbeat = ADB.va.MediaHeartbeat;                                    mediaInfo = MediaHeartbeat.createMediaObject( event.target.getVideoData().title, event.target.getVideoData().video_id, Math.floor(event.target.getDuration()), MediaHeartbeat.StreamType.VOD );                                     MediaHeartbeat = new MediaHeartbeat(mediaDelegate, mediaConfig, appMeasurement);                                    mediaDelegate.getCurrentPlaybackTime = function() { return Math.floor(event.target.getCurrentTime());                            };                                    MediaHeartbeat.trackSessionStart(mediaInfo, contextData);                                    MediaHeartbeat.trackPlay();                                    videostarted = true;                      } else { console.log(&quot;\*\*\*HB Play&quot;);                            MediaHeartbeat.trackPlay();                      }} break ;               case YT.PlayerState.PAUSED:                      console.log(&quot;\*\*\*HB Pause&quot;);                      MediaHeartbeat.trackPause();                      break;               case YT.PlayerState.ENDED:                      console.log(&quot;\*\*\*HB Ended&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      break;               cas -1 :                      console.log(&quot;\*\*\*HB Unloaded&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      break;        }

}

fonction onPlayerPlaybackQualityChange(event) { console.log(&quot;onPlayerPlaybackQualityChange: event.data: &quot;+ event.data); }

fonction onPlayerPlaybackRateChange(event) { console.log(&quot;onPlayerPlaybackRateChange: event.data: &quot;+ event.data); }

fonction onPlayerError(event) { console.log(&quot;onPlayerError: event.data: &quot;+ event.data); }



<b>ÉTAPE 8 : Ajouter un HTML</b>

Ajoutez le code suivant dans votre code de HTML.

!-- 1. L’iframe (et le lecteur vidéo) remplacera cette balise div. — div id=&quot;player&quot;/divbr

<b>ÉTAPE 8 : Publier</b>

Publiez votre propriété et testez-la.


